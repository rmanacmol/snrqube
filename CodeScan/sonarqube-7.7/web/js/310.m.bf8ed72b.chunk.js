(window.webpackJsonp=window.webpackJsonp||[]).push([[310,7],{1656:function(e,t,s){"use strict";s.r(t);var i=s(364),n=s(409),o=s.n(n),r=s(354),a=s(371),l=s.n(a),p=s(743),c=s(753),m=s(396),u=s(484);class d extends r.PureComponent{constructor(){super(...arguments),this.handleToggleUser=((e,t)=>{return e.permissions.includes(t)?this.props.revokePermissionFromUser(e.login,t):this.props.grantPermissionToUser(e.login,t)}),this.handleToggleGroup=((e,t)=>{return e.permissions.includes(t)?this.props.revokePermissionFromGroup(e.name,t):this.props.grantPermissionToGroup(e.name,t)}),this.handleSelectPermission=(e=>{this.props.onPermissionSelect(e)})}render(){const e=this.props,t=e.filter,s=e.groups,i=e.groupsPaging,n=e.users,a=e.usersPaging;let l=u.a[this.props.component.qualifier];"public"===this.props.visibility&&(l=o()(l,"user","codeviewer"));const d=Object(u.e)(l,"projects_role");let h=0,g=0;return"users"!==t&&(h+=s.length,g+=i?i.total:s.length),"groups"!==t&&(h+=n.length,g+=a?a.total:n.length),r.createElement(r.Fragment,null,r.createElement(c.a,{filter:this.props.filter,groups:this.props.groups,onSelectPermission:this.handleSelectPermission,onToggleGroup:this.handleToggleGroup,onToggleUser:this.handleToggleUser,permissions:d,query:this.props.query,selectedPermission:this.props.selectedPermission,users:this.props.users},r.createElement(p.a,{filter:this.props.filter,onFilter:this.props.onFilterChange,onSearch:this.props.onQueryChange,query:this.props.query})),r.createElement(m.a,{count:h,loadMore:this.props.onLoadMore,total:g}))}}var h=s(852),g=s(356),b=s(0);class f extends r.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={applyTemplateModal:!1},this.handleApplyTemplate=(()=>{this.setState({applyTemplateModal:!0})}),this.handleApplyTemplateClose=(()=>{this.mounted&&this.setState({applyTemplateModal:!1})})}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){const e=this.props.component,t=e.configuration,s=null!=t&&t.canApplyPermissionTemplate,i=["VW","SVW","APP"].includes(e.qualifier)?Object(b.l)("roles.page.description_portfolio"):Object(b.l)("roles.page.description2"),n="TRK"===e.qualifier&&e.visibility?Object(b.l)("visibility",e.visibility,"description",e.qualifier):void 0;return r.createElement("header",{className:"page-header"},r.createElement("h1",{className:"page-title"},Object(b.l)("permissions.page")),this.props.loading&&r.createElement("i",{className:"spinner"}),s&&r.createElement("div",{className:"page-actions"},r.createElement(g.a,{className:"js-apply-template",onClick:this.handleApplyTemplate},Object(b.l)("projects_role.apply_template")),this.state.applyTemplateModal&&r.createElement(h.a,{onApply:this.props.loadHolders,onClose:this.handleApplyTemplateClose,organization:e.organization,project:e})),r.createElement("div",{className:"page-description"},r.createElement("p",null,i),n&&r.createElement("p",null,n)))}}var y=s(401),C=s(374);function P({component:e,onClose:t,onConfirm:s}){const i=e.qualifier;return r.createElement(y.a,{confirmButtonText:Object(b.l)("projects_role.turn_project_to_public",i),header:Object(b.m)("projects_role.turn_x_to_public",e.name),onClose:t,onConfirm:s},r.createElement(C.a,{variant:"warning"},Object(b.l)("projects_role.are_you_sure_to_turn_project_to_public.warning",i)),r.createElement("p",null,Object(b.l)("projects_role.are_you_sure_to_turn_project_to_public",i)))}var v=s(755),j=s(853),E=s(496);s(744);var O=s(367);const _={fetchOrganization:s(472).e};t.default=Object(i.connect)((e,{component:t})=>({currentUser:Object(O.getCurrentUser)(e),organization:Object(O.getOrganizationByKey)(e,t.organization)}),_)(class extends r.PureComponent{constructor(e){super(e),this.mounted=!1,this.stopLoading=(()=>{this.mounted&&this.setState({loading:!1})}),this.loadUsersAndGroups=((e,t)=>{const s=this.props.component,i=this.state,n=i.filter,o=i.query,r=i.selectedPermission,a="groups"!==n?E.n({projectKey:s.key,q:o||void 0,permission:r,organization:s.organization,p:e}):Promise.resolve({paging:void 0,users:[]}),l="users"!==n?E.m({projectKey:s.key,q:o||void 0,permission:r,organization:s.organization,p:t}):Promise.resolve({paging:void 0,groups:[]});return Promise.all([a,l])}),this.loadHolders=(()=>(this.setState({loading:!0}),this.loadUsersAndGroups().then(([e,t])=>{this.mounted&&this.setState({groups:t.groups,groupsPaging:t.paging,loading:!1,users:e.users,usersPaging:e.paging})},this.stopLoading))),this.onLoadMore=(()=>{const e=this.state,t=e.usersPaging,s=e.groupsPaging;return this.setState({loading:!0}),this.loadUsersAndGroups(t?t.pageIndex+1:1,s?s.pageIndex+1:1).then(([e,t])=>{this.mounted&&this.setState(({groups:s,users:i})=>({groups:[...s,...t.groups],groupsPaging:t.paging,loading:!1,users:[...i,...e.users],usersPaging:e.paging}))},this.stopLoading)}),this.handleFilterChange=(e=>{this.mounted&&this.setState({filter:e},this.loadHolders)}),this.handleQueryChange=(e=>{this.mounted&&this.setState({query:e},this.loadHolders)}),this.handlePermissionSelect=(e=>{this.mounted&&this.setState(t=>({selectedPermission:t.selectedPermission===e?void 0:e}),this.loadHolders)}),this.addPermissionToGroup=((e,t)=>this.state.groups.map(s=>s.name===e?Object.assign({},s,{permissions:[...s.permissions,t]}):s)),this.addPermissionToUser=((e,t)=>this.state.users.map(s=>s.login===e?Object.assign({},s,{permissions:[...s.permissions,t]}):s)),this.removePermissionFromGroup=((e,t)=>this.state.groups.map(s=>s.name===e?Object.assign({},s,{permissions:o()(s.permissions,t)}):s)),this.removePermissionFromUser=((e,t)=>this.state.users.map(s=>s.login===e?Object.assign({},s,{permissions:o()(s.permissions,t)}):s)),this.grantPermissionToGroup=((e,t)=>this.mounted?(this.setState({loading:!0,groups:this.addPermissionToGroup(e,t)}),E.o({projectKey:this.props.component.key,groupName:e,permission:t,organization:this.props.component.organization}).then(this.stopLoading,()=>{this.mounted&&this.setState({loading:!1,groups:this.removePermissionFromGroup(e,t)})})):Promise.resolve()),this.grantPermissionToUser=((e,t)=>this.mounted?(this.setState({loading:!0,users:this.addPermissionToUser(e,t)}),E.p({projectKey:this.props.component.key,login:e,permission:t,organization:this.props.component.organization}).then(this.stopLoading,()=>{this.mounted&&this.setState({loading:!1,users:this.removePermissionFromUser(e,t)})})):Promise.resolve()),this.revokePermissionFromGroup=((e,t)=>this.mounted?(this.setState({loading:!0,groups:this.removePermissionFromGroup(e,t)}),E.t({projectKey:this.props.component.key,groupName:e,permission:t,organization:this.props.component.organization}).then(this.stopLoading,()=>{this.mounted&&this.setState({loading:!1,groups:this.addPermissionToGroup(e,t)})})):Promise.resolve()),this.revokePermissionFromUser=((e,t)=>this.mounted?(this.setState({loading:!0,users:this.removePermissionFromUser(e,t)}),E.u({projectKey:this.props.component.key,login:e,permission:t,organization:this.props.component.organization}).then(this.stopLoading,()=>{this.mounted&&this.setState({loading:!1,users:this.addPermissionToUser(e,t)})})):Promise.resolve()),this.handleOrganizationUpgrade=(()=>{const e=this.props,t=e.component,s=e.organization;s&&(this.props.onComponentChange({configuration:Object.assign({},t.configuration,{canUpdateProjectVisibilityToPrivate:!0})}),this.props.fetchOrganization(s.key))}),this.handleVisibilityChange=(e=>{"public"===e?this.openDisclaimer():this.turnProjectToPrivate()}),this.turnProjectToPublic=(()=>{this.props.onComponentChange({visibility:"public"}),E.e(this.props.component.key,"public").then(()=>{this.loadHolders()},()=>{this.props.onComponentChange({visibility:"private"})})}),this.turnProjectToPrivate=(()=>{this.props.onComponentChange({visibility:"private"}),E.e(this.props.component.key,"private").then(()=>{this.loadHolders()},()=>{this.props.onComponentChange({visibility:"public"})})}),this.openDisclaimer=(()=>{this.mounted&&this.setState({disclaimer:!0})}),this.closeDisclaimer=(()=>{this.mounted&&this.setState({disclaimer:!1})}),this.state={disclaimer:!1,filter:"all",groups:[],loading:!0,query:"",users:[]}}componentDidMount(){this.mounted=!0,this.loadHolders()}componentWillUnmount(){this.mounted=!1}render(){const e=this.props,t=e.component,s=e.organization,i=t.configuration&&t.configuration.canUpdateProjectVisibilityToPrivate;let n;return s&&!i&&(n=s.actions&&s.actions.admin&&"TRK"===this.props.component.qualifier&&!s.canUpdateProjectsVisibilityToPrivate),r.createElement("div",{className:"page page-limited",id:"project-permissions-page"},r.createElement(l.a,{title:Object(b.l)("permissions.page")}),r.createElement(f,{component:t,loadHolders:this.loadHolders,loading:this.state.loading}),r.createElement("div",null,r.createElement(j.a,{canTurnToPrivate:i,className:"big-spacer-top big-spacer-bottom",onChange:this.handleVisibilityChange,visibility:t.visibility}),n&&s&&r.createElement(v.a,{className:"big-spacer-bottom",onOrganizationUpgrade:this.handleOrganizationUpgrade,organization:s}),this.state.disclaimer&&r.createElement(P,{component:t,onClose:this.closeDisclaimer,onConfirm:this.turnProjectToPublic})),r.createElement(d,{component:t,filter:this.state.filter,grantPermissionToGroup:this.grantPermissionToGroup,grantPermissionToUser:this.grantPermissionToUser,groups:this.state.groups,groupsPaging:this.state.groupsPaging,onFilterChange:this.handleFilterChange,onLoadMore:this.onLoadMore,onPermissionSelect:this.handlePermissionSelect,onQueryChange:this.handleQueryChange,query:this.state.query,revokePermissionFromGroup:this.revokePermissionFromGroup,revokePermissionFromUser:this.revokePermissionFromUser,selectedPermission:this.state.selectedPermission,users:this.state.users,usersPaging:this.state.usersPaging,visibility:t.visibility}))}})},484:function(e,t,s){"use strict";s.d(t,"b",function(){return n}),s.d(t,"c",function(){return o}),s.d(t,"d",function(){return r}),s.d(t,"a",function(){return l}),s.d(t,"e",function(){return c}),s.d(t,"f",function(){return m});var i=s(0);const n=["user","codeviewer","issueadmin","securityhotspotadmin","admin","scan"],o=["admin",{category:"administer",permissions:["gateadmin","profileadmin"]},"scan",{category:"creator",permissions:["provisioning"]}],r=["admin",{category:"administer",permissions:["gateadmin","profileadmin"]},"scan",{category:"creator",permissions:["provisioning","applicationcreator","portfoliocreator"]}],a=["user","admin"],l={TRK:n,VW:a,SVW:a,APP:a,DEV:["user","admin"]};function p(e,t){return{key:e,name:Object(i.l)(t,e),description:Object(i.l)(t,e,"desc")}}function c(e,t){return e.map(e=>"object"==typeof e?{category:e.category,permissions:e.permissions.map(e=>p(e,t))}:p(e,t))}function m(e){return Boolean(e&&e.category)}},496:function(e,t,s){"use strict";s.d(t,"p",function(){return r}),s.d(t,"u",function(){return a}),s.d(t,"o",function(){return l}),s.d(t,"t",function(){return p}),s.d(t,"l",function(){return c}),s.d(t,"f",function(){return m}),s.d(t,"y",function(){return u}),s.d(t,"g",function(){return d}),s.d(t,"x",function(){return h}),s.d(t,"b",function(){return g}),s.d(t,"c",function(){return b}),s.d(t,"r",function(){return f}),s.d(t,"w",function(){return y}),s.d(t,"q",function(){return C}),s.d(t,"v",function(){return P}),s.d(t,"a",function(){return v}),s.d(t,"s",function(){return j}),s.d(t,"n",function(){return E}),s.d(t,"m",function(){return O}),s.d(t,"i",function(){return _}),s.d(t,"h",function(){return T}),s.d(t,"k",function(){return S}),s.d(t,"j",function(){return k}),s.d(t,"e",function(){return N}),s.d(t,"d",function(){return U});var i=s(4),n=s(372);const o=100;function r(e){return Object(i.post)("/api/permissions/add_user",e).catch(n.a)}function a(e){return Object(i.post)("/api/permissions/remove_user",e).catch(n.a)}function l(e){return Object(i.post)("/api/permissions/add_group",e).catch(n.a)}function p(e){return Object(i.post)("/api/permissions/remove_group",e).catch(n.a)}function c(e){const t="/api/permissions/search_templates";return e?Object(i.getJSON)(t,{organization:e}):Object(i.getJSON)(t)}function m(e){return Object(i.postJSON)("/api/permissions/create_template",e)}function u(e){return Object(i.post)("/api/permissions/update_template",e)}function d(e){return Object(i.post)("/api/permissions/delete_template",e).catch(n.a)}function h(e,t){return Object(i.post)("/api/permissions/set_default_template",{templateId:e,qualifier:t})}function g(e){return Object(i.post)("/api/permissions/apply_template",e).catch(n.a)}function b(e){return Object(i.post)("/api/permissions/bulk_apply_template",e)}function f(e){return Object(i.post)("/api/permissions/add_user_to_template",e)}function y(e){return Object(i.post)("/api/permissions/remove_user_from_template",e)}function C(e){return Object(i.post)("/api/permissions/add_group_to_template",e)}function P(e){return Object(i.post)("/api/permissions/remove_group_from_template",e)}function v(e,t){return Object(i.post)("/api/permissions/add_project_creator_to_template",{templateId:e,permission:t})}function j(e,t){return Object(i.post)("/api/permissions/remove_project_creator_from_template",{templateId:e,permission:t})}function E(e){return e.ps||(e.ps=o),Object(i.getJSON)("/api/permissions/users",e).catch(n.a)}function O(e){return e.ps||(e.ps=o),Object(i.getJSON)("/api/permissions/groups",e).catch(n.a)}function _(e){return e.ps||(e.ps=o),Object(i.getJSON)("/api/permissions/users",e)}function T(e){return e.ps||(e.ps=o),Object(i.getJSON)("/api/permissions/groups",e)}function S(e,t,s,n){const r={templateId:e,ps:o};return t&&(r.q=t),s&&(r.permission=s),n&&Object.assign(r,{organization:n}),Object(i.getJSON)("/api/permissions/template_users",r).then(e=>e.users)}function k(e,t,s,n){const r={templateId:e,ps:o};return t&&(r.q=t),s&&(r.permission=s),n&&Object.assign(r,{organization:n}),Object(i.getJSON)("/api/permissions/template_groups",r).then(e=>e.groups)}function N(e,t){return Object(i.post)("/api/projects/update_visibility",{project:e,visibility:t}).catch(n.a)}function U(e,t){return Object(i.post)("/api/projects/update_default_visibility",{organization:e,projectVisibility:t}).catch(n.a)}},522:function(e,t,s){var i=s(449)(function(e,t,s){e[s?0:1].push(t)},function(){return[[],[]]});e.exports=i},651:function(e,t,s){"use strict";s.d(t,"a",function(){return r});var i=s(354),n=s(359),o=s(361);function r({className:e,fill:t=o.gray67,size:s=36}){return i.createElement(n.a,{className:e,size:s,viewBox:"0 0 36 36"},i.createElement("g",{transform:"matrix(0.0625,0,0,0.0625,3,4)"},i.createElement("path",{d:"M148.25,224C121.25,224.833 99.167,235.5 82,256L48.5,256C34.833,256 23.333,252.625 14,245.875C4.667,239.125 0,229.25 0,216.25C0,157.417 10.333,128 31,128C32,128 35.625,129.75 41.875,133.25C48.125,136.75 56.25,140.292 66.25,143.875C76.25,147.458 86.167,149.25 96,149.25C107.167,149.25 118.25,147.333 129.25,143.5C128.417,149.667 128,155.167 128,160C128,183.167 134.75,204.5 148.25,224ZM416,383.25C416,403.25 409.917,419.042 397.75,430.625C385.583,442.208 369.417,448 349.25,448L130.75,448C110.583,448 94.417,442.208 82.25,430.625C70.083,419.042 64,403.25 64,383.25C64,374.417 64.292,365.792 64.875,357.375C65.458,348.958 66.625,339.875 68.375,330.125C70.125,320.375 72.333,311.333 75,303C77.667,294.667 81.25,286.542 85.75,278.625C90.25,270.708 95.417,263.958 101.25,258.375C107.083,252.792 114.208,248.333 122.625,245C131.042,241.667 140.333,240 150.5,240C152.167,240 155.75,241.792 161.25,245.375C166.75,248.958 172.833,252.958 179.5,257.375C186.167,261.792 195.083,265.792 206.25,269.375C217.417,272.958 228.667,274.75 240,274.75C251.333,274.75 262.583,272.958 273.75,269.375C284.917,265.792 293.833,261.792 300.5,257.375C307.167,252.958 313.25,248.958 318.75,245.375C324.25,241.792 327.833,240 329.5,240C339.667,240 348.958,241.667 357.375,245C365.792,248.333 372.917,252.792 378.75,258.375C384.583,263.958 389.75,270.708 394.25,278.625C398.75,286.542 402.333,294.667 405,303C407.667,311.333 409.875,320.375 411.625,330.125C413.375,339.875 414.542,348.958 415.125,357.375C415.708,365.792 416,374.417 416,383.25ZM160,64C160,81.667 153.75,96.75 141.25,109.25C128.75,121.75 113.667,128 96,128C78.333,128 63.25,121.75 50.75,109.25C38.25,96.75 32,81.667 32,64C32,46.333 38.25,31.25 50.75,18.75C63.25,6.25 78.333,0 96,0C113.667,0 128.75,6.25 141.25,18.75C153.75,31.25 160,46.333 160,64ZM336,160C336,186.5 326.625,209.125 307.875,227.875C289.125,246.625 266.5,256 240,256C213.5,256 190.875,246.625 172.125,227.875C153.375,209.125 144,186.5 144,160C144,133.5 153.375,110.875 172.125,92.125C190.875,73.375 213.5,64 240,64C266.5,64 289.125,73.375 307.875,92.125C326.625,110.875 336,133.5 336,160ZM480,216.25C480,229.25 475.333,239.125 466,245.875C456.667,252.625 445.167,256 431.5,256L398,256C380.833,235.5 358.75,224.833 331.75,224C345.25,204.5 352,183.167 352,160C352,155.167 351.583,149.667 350.75,143.5C361.75,147.333 372.833,149.25 384,149.25C393.833,149.25 403.75,147.458 413.75,143.875C423.75,140.292 431.875,136.75 438.125,133.25C444.375,129.75 448,128 449,128C469.667,128 480,157.417 480,216.25ZM448,64C448,81.667 441.75,96.75 429.25,109.25C416.75,121.75 401.667,128 384,128C366.333,128 351.25,121.75 338.75,109.25C326.25,96.75 320,81.667 320,64C320,46.333 326.25,31.25 338.75,18.75C351.25,6.25 366.333,0 384,0C401.667,0 416.75,6.25 429.25,18.75C441.75,31.25 448,46.333 448,64Z",style:{fill:t}})))}},743:function(e,t,s){"use strict";s.d(t,"a",function(){return a});var i=s(354),n=s(433),o=s(405),r=s(0);function a(e){const t=[{value:"all",label:Object(r.l)("all")},{value:"users",label:Object(r.l)("users.page")},{value:"groups",label:Object(r.l)("user_groups.page")}];return i.createElement("div",{className:"display-flex-row"},i.createElement(n.a,{name:"users-or-groups",onCheck:e.onFilter,options:t,value:e.filter}),i.createElement("div",{className:"flex-1 spacer-left"},i.createElement(o.a,{minLength:3,onChange:e.onSearch,placeholder:Object(r.l)("search.search_for_users_or_groups"),value:e.query})))}},744:function(e,t,s){var i=s(851);"string"==typeof i&&(i=[[e.i,i,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};s(358)(i,n);i.locals&&(e.exports=i.locals)},753:function(e,t,s){"use strict";var i=s(370),n=s.n(i),o=s(522),r=s.n(o),a=s(354),l=s(409),p=s.n(l),c=s(355),m=s(484),u=s(386);class d extends a.PureComponent{render(){const e=this.props,t=e.loading,s=e.onCheck,i=e.permission,n=e.permissionItem,o=e.selectedPermission;return Object(m.f)(i)?a.createElement("td",{className:"text-middle"},i.permissions.map(e=>a.createElement("div",{key:e.key},a.createElement(u.a,{checked:n.permissions.includes(e.key),disabled:t.includes(e.key),id:e.key,onCheck:s},a.createElement("span",{className:"little-spacer-left"},e.name))))):a.createElement("td",{className:c("permission-column text-center text-middle",{selected:i.key===o})},a.createElement(u.a,{checked:n.permissions.includes(i.key),disabled:t.includes(i.key),id:i.key,onCheck:s}))}}var h=s(422),g=s(0),b=s(13);class f extends a.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={loading:[]},this.stopLoading=(e=>{this.mounted&&this.setState(t=>({loading:p()(t.loading,e)}))}),this.handleCheck=((e,t)=>{void 0!==t&&(this.setState(e=>({loading:[...e.loading,t]})),this.props.onToggle(this.props.user,t).then(()=>this.stopLoading(t),()=>this.stopLoading(t)))})}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){const e=this.props.user,t=this.props.permissions.map(t=>a.createElement(d,{key:Object(m.f)(t)?t.category:t.key,loading:this.state.loading,onCheck:this.handleCheck,permission:t,permissionItem:e,selectedPermission:this.props.selectedPermission}));return"<creator>"===e.login?a.createElement("tr",null,a.createElement("td",{className:"nowrap text-middle"},a.createElement("div",{className:"display-inline-block text-middle"},a.createElement("div",null,a.createElement("strong",null,e.name)),a.createElement("div",{className:"little-spacer-top",style:{whiteSpace:"normal"}},Object(g.l)(Object(b.isSonarCloud)()?"permission_templates.project_creators.explanation.sonarcloud":"permission_templates.project_creators.explanation")))),t):a.createElement("tr",null,a.createElement("td",{className:"nowrap text-middle"},a.createElement(h.a,{className:"text-middle big-spacer-right",hash:e.avatar,name:e.name,size:36}),a.createElement("div",{className:"display-inline-block text-middle"},a.createElement("div",null,a.createElement("strong",null,e.name),a.createElement("span",{className:"note spacer-left"},e.login)),a.createElement("div",{className:"little-spacer-top"},e.email))),t)}}var y=s(651);class C extends a.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={loading:[]},this.stopLoading=(e=>{this.mounted&&this.setState(t=>({loading:p()(t.loading,e)}))}),this.handleCheck=((e,t)=>{void 0!==t&&(this.setState(e=>({loading:[...e.loading,t]})),this.props.onToggle(this.props.group,t).then(()=>this.stopLoading(t),()=>this.stopLoading(t)))})}componentDidMount(){this.mounted=!0}componentWillUnmount(){this.mounted=!1}render(){const e=this.props.group;return a.createElement("tr",null,a.createElement("td",{className:"nowrap text-middle"},a.createElement("div",{className:"display-inline-block text-middle big-spacer-right"},a.createElement(y.a,null)),a.createElement("div",{className:"display-inline-block text-middle"},a.createElement("div",null,a.createElement("strong",null,e.name)),a.createElement("div",{className:"little-spacer-top",style:{whiteSpace:"normal"}},e.description))),this.props.permissions.map(t=>a.createElement(d,{key:Object(m.f)(t)?t.category:t.key,loading:this.state.loading,onCheck:this.handleCheck,permission:t,permissionItem:e,selectedPermission:this.props.selectedPermission})))}}var P=s(373),v=s(432),j=s(363),E=s(374);class O extends a.PureComponent{constructor(){super(...arguments),this.handlePermissionClick=(e=>{e.preventDefault(),e.currentTarget.blur();const t=this.props.permission;this.props.onSelectPermission&&!Object(m.f)(t)&&this.props.onSelectPermission(t.key)}),this.getTooltipOverlay=(()=>{const e=this.props.permission;return Object(m.f)(e)?e.permissions.map(e=>a.createElement(a.Fragment,null,a.createElement("b",{className:"little-spacer-right"},e.name,":"),a.createElement(v.a,{key:e.key,message:e.description}),a.createElement("br",null))):this.props.showPublicProjectsWarning&&["user","codeviewer"].includes(e.key)?a.createElement("div",null,a.createElement(v.a,{message:e.description}),a.createElement(E.a,{className:"spacer-top",variant:"warning"},Object(g.l)("projects_role.public_projects_warning"))):a.createElement(v.a,{message:e.description})})}render(){const e=this.props,t=e.onSelectPermission,s=e.permission;let i;return i=Object(m.f)(s)?Object(g.l)("global_permissions",s.category):t?a.createElement(j.a,{overlay:Object(g.m)("global_permissions.filter_by_x_permission",s.name)},a.createElement("a",{href:"#",onClick:this.handlePermissionClick},s.name)):s.name,a.createElement("th",{className:c("permission-column text-center text-middle",{selected:!Object(m.f)(s)&&s.key===this.props.selectedPermission})},a.createElement("div",{className:"permission-column-inner"},i,a.createElement(P.a,{className:"spacer-left",overlay:this.getTooltipOverlay()})))}}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var s=[],i=!0,n=!1,o=void 0;try{for(var r,a=e[Symbol.iterator]();!(i=(r=a.next()).done)&&(s.push(r.value),!t||s.length!==t);i=!0);}catch(e){n=!0,o=e}finally{try{i||null==a.return||a.return()}finally{if(n)throw o}}return s}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}s.d(t,"a",function(){return T});class T extends a.PureComponent{constructor(){super(...arguments),this.state={initialPermissionsCount:{}},this.handleGroupToggle=((e,t)=>{const s=e.id||e.name;return void 0===this.state.initialPermissionsCount[s]&&this.setState(t=>({initialPermissionsCount:Object.assign({},t.initialPermissionsCount,{[s]:e.permissions.length})})),this.props.onToggleGroup(e,t)}),this.handleUserToggle=((e,t)=>(void 0===this.state.initialPermissionsCount[e.login]&&this.setState(t=>({initialPermissionsCount:Object.assign({},t.initialPermissionsCount,{[e.login]:e.permissions.length})})),this.props.onToggleUser(e,t))),this.getItemInitialPermissionsCount=(e=>{const t=this.isPermissionUser(e)?e.login:e.id||e.name;return void 0!==this.state.initialPermissionsCount[t]?this.state.initialPermissionsCount[t]:e.permissions.length})}componentDidUpdate(e){this.props.filter===e.filter&&this.props.query===e.query||this.setState({initialPermissionsCount:{}})}isPermissionUser(e){return void 0!==e.login}renderEmpty(){const e=this.props.permissions.length+1;return a.createElement("tr",null,a.createElement("td",{colSpan:e},Object(g.l)("no_results_search")))}renderItem(e,t){return this.isPermissionUser(e)?a.createElement(f,{key:`user-${e.login}`,onToggle:this.handleUserToggle,permissions:t,selectedPermission:this.props.selectedPermission,user:e}):a.createElement(C,{group:e,key:`group-${e.id||e.name}`,onToggle:this.handleGroupToggle,permissions:t,selectedPermission:this.props.selectedPermission})}render(){const e=this.props.permissions,t=n()([...this.props.users,...this.props.groups],e=>this.isPermissionUser(e)&&"<creator>"===e.login?0:e.name),s=_(r()(t,e=>this.getItemInitialPermissionsCount(e)),2),i=s[0],o=s[1];return a.createElement("div",{className:"boxed-group boxed-group-inner"},a.createElement("table",{className:"data zebra permissions-table"},a.createElement("thead",null,a.createElement("tr",null,a.createElement("td",{className:"nowrap bordered-bottom"},this.props.children),e.map(e=>a.createElement(O,{key:Object(m.f)(e)?e.category:e.key,onSelectPermission:this.props.onSelectPermission,permission:e,selectedPermission:this.props.selectedPermission,showPublicProjectsWarning:this.props.showPublicProjectsWarning})))),a.createElement("tbody",null,0===t.length&&!this.props.loading&&this.renderEmpty(),i.map(t=>this.renderItem(t,e)),i.length>0&&o.length>0&&a.createElement(a.Fragment,null,a.createElement("tr",null,a.createElement("td",{className:"divider",colSpan:20})),a.createElement("tr",null)),o.map(t=>this.renderItem(t,e)))))}}},851:function(e,t,s){(e.exports=s(357)(!1)).push([e.i,"/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n.permissions-table .permission-column.selected {\n  background-color: #d9edf7;\n}\n\n.permissions-table .permission-column-inner {\n  display: inline-block;\n  width: 100px;\n}\n\n.permissions-table .divider {\n  background: #fff;\n  padding: 16px 0;\n}\n.permissions-table .divider::after {\n  display: block;\n  content: '';\n  background: #e6e6e6;\n  height: 1px;\n  width: 100%;\n}\n",""])},852:function(e,t,s){"use strict";s.d(t,"a",function(){return m});var i=s(354),n=s(496),o=s(366),r=s(382),a=s(375),l=s(356),p=s(0),c=s(374);class m extends i.PureComponent{constructor(){super(...arguments),this.mounted=!1,this.state={done:!1,loading:!0},this.fetchPermissionTemplates=(()=>{Object(n.l)(this.props.organization).then(({permissionTemplates:e})=>{this.mounted&&this.setState({loading:!1,permissionTemplates:e})},()=>{this.mounted&&this.setState({loading:!1})})}),this.handleSubmit=(()=>this.state.permissionTemplate?Object(n.b)({organization:this.props.organization,projectKey:this.props.project.key,templateId:this.state.permissionTemplate}).then(()=>{this.mounted&&(this.props.onApply&&this.props.onApply(),this.setState({done:!0}))}):Promise.reject(void 0)),this.handlePermissionTemplateChange=(({value:e})=>{this.setState({permissionTemplate:e})})}componentDidMount(){this.mounted=!0,this.fetchPermissionTemplates()}componentWillUnmount(){this.mounted=!1}render(){const e=Object(p.m)("projects_role.apply_template_to_xxx",this.props.project.name);return i.createElement(r.a,{header:e,onClose:this.props.onClose,onSubmit:this.handleSubmit,size:"small"},({onCloseClick:t,onFormSubmit:s,submitting:n})=>i.createElement("form",{id:"project-permissions-apply-template-form",onSubmit:s},i.createElement("header",{className:"modal-head"},i.createElement("h2",null,e)),i.createElement("div",{className:"modal-body"},this.state.done?i.createElement(c.a,{variant:"success"},Object(p.l)("projects_role.apply_template.success")):i.createElement(i.Fragment,null,this.state.loading?i.createElement("i",{className:"spinner"}):i.createElement("div",{className:"modal-field"},i.createElement("label",{htmlFor:"project-permissions-template"},Object(p.l)("template"),i.createElement("em",{className:"mandatory"},"*")),this.state.permissionTemplates&&i.createElement(a.c,{clearable:!1,id:"project-permissions-template",onChange:this.handlePermissionTemplateChange,options:this.state.permissionTemplates.map(e=>({label:e.name,value:e.id})),value:this.state.permissionTemplate})))),i.createElement("footer",{className:"modal-foot"},i.createElement(o.a,{className:"spacer-right",loading:n}),!this.state.done&&i.createElement(l.h,{disabled:n||!this.state.permissionTemplate},Object(p.l)("apply")),i.createElement(l.g,{onClick:t},Object(p.l)(this.state.done?"close":"cancel")))))}}}}]);
//# sourceMappingURL=310.m.bf8ed72b.chunk.js.map
{"version":3,"sources":["webpack:///./src/main/js/apps/portfolio/components/CreateFormShim.tsx","webpack:///./src/main/js/components/icons-components/PlusIcon.tsx","webpack:///./src/main/js/app/components/nav/global/GlobalNavPlus.tsx","webpack:///./node_modules/lodash/toFinite.js","webpack:///./node_modules/lodash/_baseInRange.js","webpack:///./node_modules/lodash/inRange.js","webpack:///./src/main/js/api/nav.ts"],"names":["CreateFormShim_CreateFormShim","index_js_exposed","[object Object]","CreateForm","window","SonarGovernance","Object","assign","this","props","PlusIcon","className","fill","size","Icon","d","style","__webpack_require__","__webpack_exports__","GlobalNavPlus_GlobalNavPlus","mounted","state","createPortfolio","governanceReady","handleNewProjectClick","event","preventDefault","openProjectOnboarding","openCreatePortfolioForm","setState","closeCreatePortfolioForm","handleNewPortfolioClick","currentTarget","blur","handleCreatePortfolio","key","qualifier","nav","component","then","data","configuration","extensions","find","item","router","push","urls","appState","qualifiers","includes","utils","canCreateProject","href","onClick","system","l10n","canCreateOrg","es","to","showGovernanceEntry","defaultQualifier","currentUser","canCreateApplication","users","canCreatePortfolio","Dropdown","overlay","renderCreateProject","renderCreateOrganization","renderCreatePortfolio","tagName","title","onClose","onCreate","toNumber","INFINITY","MAX_INTEGER","module","exports","value","nativeMax","Math","max","nativeMin","min","number","start","end","baseInRange","toFinite","undefined","getComponentNavigation","getMarketplaceNavigation","getSettingsNavigation","_helpers_request__WEBPACK_IMPORTED_MODULE_0__","_app_utils_throwGlobalError__WEBPACK_IMPORTED_MODULE_1__","catch"],"mappings":"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","file":"js/338.m.546eb7aa.chunk.js","sourcesContent":["/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\n\ninterface Props {\n  defaultQualifier?: string;\n  onClose: () => void;\n  onCreate: (portfolio: { key: string; qualifier: string }) => void;\n}\n\nexport default class CreateFormShim extends React.Component<Props> {\n  render() {\n    const { CreateForm } = (window as any).SonarGovernance;\n    return <CreateForm {...this.props} />;\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport Icon, { IconProps } from './Icon';\n\nexport default function PlusIcon({ className, fill = 'currentColor', size }: IconProps) {\n  return (\n    <Icon className={className} size={size}>\n      <path d=\"M1,7L7,7L7,1L9,1L9,7L15,7L15,9L9,9L9,15L7,15L7,9L1,9L1,7Z\" style={{ fill }} />\n    </Icon>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Link, withRouter, WithRouterProps } from 'react-router';\nimport CreateFormShim from '../../../../apps/portfolio/components/CreateFormShim';\nimport Dropdown from '../../../../components/controls/Dropdown';\nimport PlusIcon from '../../../../components/icons-components/PlusIcon';\nimport { getExtensionStart } from '../../extensions/utils';\nimport { getComponentNavigation } from '../../../../api/nav';\nimport { translate } from '../../../../helpers/l10n';\nimport { isSonarCloud } from '../../../../helpers/system';\nimport { getPortfolioAdminUrl, getPortfolioUrl } from '../../../../helpers/urls';\nimport { hasGlobalPermission } from '../../../../helpers/users';\nimport { OnboardingContextShape } from '../../OnboardingContext';\n\ninterface Props {\n  appState: Pick<T.AppState, 'qualifiers'>;\n  currentUser: T.LoggedInUser;\n  openProjectOnboarding: OnboardingContextShape;\n}\n\ninterface State {\n  createPortfolio: boolean;\n  governanceReady: boolean;\n}\n\nexport class GlobalNavPlus extends React.PureComponent<Props & WithRouterProps, State> {\n  mounted = false;\n  state: State = { createPortfolio: false, governanceReady: false };\n\n  componentDidMount() {\n    this.mounted = true;\n    if (this.props.appState.qualifiers.includes('VW')) {\n      getExtensionStart('governance/console').then(\n        () => {\n          if (this.mounted) {\n            this.setState({ governanceReady: true });\n          }\n        },\n        () => {}\n      );\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  handleNewProjectClick = (event: React.MouseEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    this.props.openProjectOnboarding();\n  };\n\n  openCreatePortfolioForm = () => {\n    this.setState({ createPortfolio: true });\n  };\n\n  closeCreatePortfolioForm = () => {\n    this.setState({ createPortfolio: false });\n  };\n\n  handleNewPortfolioClick = (event: React.MouseEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    this.openCreatePortfolioForm();\n  };\n\n  handleCreatePortfolio = ({ key, qualifier }: { key: string; qualifier: string }) => {\n    return getComponentNavigation({ component: key }).then(data => {\n      if (\n        data.configuration &&\n        data.configuration.extensions &&\n        data.configuration.extensions.find(\n          (item: { key: string; name: string }) => item.key === 'governance/console'\n        )\n      ) {\n        this.props.router.push(getPortfolioAdminUrl(key, qualifier));\n      } else {\n        this.props.router.push(getPortfolioUrl(key));\n      }\n      this.closeCreatePortfolioForm();\n    });\n  };\n\n  renderCreateProject(canCreateProject: boolean) {\n    if (!canCreateProject) {\n      return null;\n    }\n    return (\n      <li>\n        <a className=\"js-new-project\" href=\"#\" onClick={this.handleNewProjectClick}>\n          {isSonarCloud()\n            ? translate('provisioning.analyze_new_project')\n            : translate('my_account.create_new.TRK')}\n        </a>\n      </li>\n    );\n  }\n\n  renderCreateOrganization(canCreateOrg: boolean) {\n    if (!canCreateOrg) {\n      return null;\n    }\n\n    return (\n      <li>\n        <Link className=\"js-new-organization\" to=\"/create-organization\">\n          {translate('my_account.create_new_organization')}\n        </Link>\n      </li>\n    );\n  }\n\n  renderCreatePortfolio(showGovernanceEntry: boolean, defaultQualifier?: string) {\n    const governanceInstalled = this.props.appState.qualifiers.includes('VW');\n    if (!governanceInstalled || !showGovernanceEntry) {\n      return null;\n    }\n\n    return (\n      <li>\n        <a className=\"js-new-portfolio\" href=\"#\" onClick={this.handleNewPortfolioClick}>\n          {defaultQualifier\n            ? translate('my_account.create_new', defaultQualifier)\n            : translate('my_account.create_new_portfolio_application')}\n        </a>\n      </li>\n    );\n  }\n\n  render() {\n    const { currentUser } = this.props;\n    const canCreateApplication = hasGlobalPermission(currentUser, 'applicationcreator');\n    const canCreateOrg = isSonarCloud();\n    const canCreatePortfolio = hasGlobalPermission(currentUser, 'portfoliocreator');\n    const canCreateProject = isSonarCloud() || hasGlobalPermission(currentUser, 'provisioning');\n\n    if (!canCreateProject && !canCreateApplication && !canCreatePortfolio && !canCreateOrg) {\n      return null;\n    }\n\n    let defaultQualifier: string | undefined;\n    if (!canCreateApplication) {\n      defaultQualifier = 'VW';\n    } else if (!canCreatePortfolio) {\n      defaultQualifier = 'APP';\n    }\n\n    return (\n      <>\n        <Dropdown\n          overlay={\n            <ul className=\"menu\">\n              {this.renderCreateProject(canCreateProject)}\n              {this.renderCreateOrganization(canCreateOrg)}\n              {this.renderCreatePortfolio(\n                canCreateApplication || canCreatePortfolio,\n                defaultQualifier\n              )}\n            </ul>\n          }\n          tagName=\"li\">\n          <a\n            className=\"navbar-icon navbar-plus\"\n            href=\"#\"\n            title={\n              isSonarCloud()\n                ? translate('my_account.create_new_project_or_organization')\n                : translate('my_account.create_new_project_portfolio_or_application')\n            }>\n            <PlusIcon />\n          </a>\n        </Dropdown>\n        {this.state.governanceReady &&\n          this.state.createPortfolio && (\n            <CreateFormShim\n              defaultQualifier={defaultQualifier}\n              onClose={this.closeCreatePortfolioForm}\n              onCreate={this.handleCreatePortfolio}\n            />\n          )}\n      </>\n    );\n  }\n}\n\nexport default withRouter(GlobalNavPlus);\n","var toNumber = require('./toNumber');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0,\n    MAX_INTEGER = 1.7976931348623157e+308;\n\n/**\n * Converts `value` to a finite number.\n *\n * @static\n * @memberOf _\n * @since 4.12.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted number.\n * @example\n *\n * _.toFinite(3.2);\n * // => 3.2\n *\n * _.toFinite(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toFinite(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toFinite('3.2');\n * // => 3.2\n */\nfunction toFinite(value) {\n  if (!value) {\n    return value === 0 ? value : 0;\n  }\n  value = toNumber(value);\n  if (value === INFINITY || value === -INFINITY) {\n    var sign = (value < 0 ? -1 : 1);\n    return sign * MAX_INTEGER;\n  }\n  return value === value ? value : 0;\n}\n\nmodule.exports = toFinite;\n","/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * The base implementation of `_.inRange` which doesn't coerce arguments.\n *\n * @private\n * @param {number} number The number to check.\n * @param {number} start The start of the range.\n * @param {number} end The end of the range.\n * @returns {boolean} Returns `true` if `number` is in the range, else `false`.\n */\nfunction baseInRange(number, start, end) {\n  return number >= nativeMin(start, end) && number < nativeMax(start, end);\n}\n\nmodule.exports = baseInRange;\n","var baseInRange = require('./_baseInRange'),\n    toFinite = require('./toFinite'),\n    toNumber = require('./toNumber');\n\n/**\n * Checks if `n` is between `start` and up to, but not including, `end`. If\n * `end` is not specified, it's set to `start` with `start` then set to `0`.\n * If `start` is greater than `end` the params are swapped to support\n * negative ranges.\n *\n * @static\n * @memberOf _\n * @since 3.3.0\n * @category Number\n * @param {number} number The number to check.\n * @param {number} [start=0] The start of the range.\n * @param {number} end The end of the range.\n * @returns {boolean} Returns `true` if `number` is in the range, else `false`.\n * @see _.range, _.rangeRight\n * @example\n *\n * _.inRange(3, 2, 4);\n * // => true\n *\n * _.inRange(4, 8);\n * // => true\n *\n * _.inRange(4, 2);\n * // => false\n *\n * _.inRange(2, 2);\n * // => false\n *\n * _.inRange(1.2, 2);\n * // => true\n *\n * _.inRange(5.2, 4);\n * // => false\n *\n * _.inRange(-3, -2, -6);\n * // => true\n */\nfunction inRange(number, start, end) {\n  start = toFinite(start);\n  if (end === undefined) {\n    end = start;\n    start = 0;\n  } else {\n    end = toFinite(end);\n  }\n  number = toNumber(number);\n  return baseInRange(number, start, end);\n}\n\nmodule.exports = inRange;\n","/*\n * SonarQube\n * Copyright (C) 2009-2019 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { getJSON } from '../helpers/request';\nimport throwGlobalError from '../app/utils/throwGlobalError';\n\nexport function getGlobalNavigation(): Promise<T.AppState> {\n  return getJSON('/api/navigation/global');\n}\n\nexport function getComponentNavigation(\n  data: { component: string } & T.BranchParameters\n): Promise<any> {\n  return getJSON('/api/navigation/component', data).catch(throwGlobalError);\n}\n\nexport function getMarketplaceNavigation(): Promise<{ serverId: string; ncloc: number }> {\n  return getJSON('/api/navigation/marketplace').catch(throwGlobalError);\n}\n\nexport function getSettingsNavigation(): Promise<any> {\n  return getJSON('/api/navigation/settings').catch(throwGlobalError);\n}\n"],"sourceRoot":""}
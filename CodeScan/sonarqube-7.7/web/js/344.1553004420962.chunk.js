(window.webpackJsonp=window.webpackJsonp||[]).push([[344],{1907:function(t,e,n){"use strict";n.r(e);var a=n(592),o=n(609),r=n.n(o),i=n(624),l=n(17);function c(){return a.createElement("header",{className:"page-header"},a.createElement("div",{className:"page-title display-flex-center"},a.createElement("h1",null,Object(l.l)("project_quality_gate.page")),a.createElement(i.a,{className:"spacer-left",doc:Promise.resolve().then(n.t.bind(null,1210,7))})),a.createElement("div",{className:"page-description"},Object(l.l)("project_quality_gate.page.description")))}var s,u=n(613),p=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mounted=!1,e.state={loading:!1},e.stopLoading=function(){e.mounted&&e.setState({loading:!1})},e.handleChange=function(t){var n=e.props.gate,a=null==n&&null!=t.value,o=null!=n&&null==t.value,r=null!=n&&n.id!==Number(t.value);(a||o||r)&&(e.setState({loading:!0}),e.props.onChange(n&&n.id,Number(t.value)).then(e.stopLoading,e.stopLoading))},e.renderGateName=function(t){return t.isDefault?a.createElement("span",null,a.createElement("strong",null,Object(l.l)("default")),": ",t.label):a.createElement("span",null,t.label)},e}return p(e,t),e.prototype.componentDidMount=function(){this.mounted=!0},e.prototype.componentWillUnmount=function(){this.mounted=!1},e.prototype.renderSelect=function(){var t=this.props,e=t.gate,n=t.allGates.map(function(t){return{value:String(t.id),label:t.name,isDefault:t.isDefault}});return a.createElement(u.c,{clearable:!1,disabled:this.state.loading,onChange:this.handleChange,optionRenderer:this.renderGateName,options:n,style:{width:300},value:e&&String(e.id),valueRenderer:this.renderGateName})},e.prototype.render=function(){return a.createElement("div",null,this.renderSelect(),this.state.loading&&a.createElement("i",{className:"spinner spacer-left"}))},e}(a.PureComponent),f=n(720),h=n(615),m=n(695),g=n(805),y=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function a(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mounted=!1,e.state={loading:!0},e.handleChangeGate=function(t,n){var a=e.state.allGates;if(!t&&!n||!a)return Promise.resolve();var o=e.props.component,r={gateId:n||t,organization:o.organization,projectKey:o.key};return(n?Object(f.a)(r):Object(f.g)(r)).then(function(){if(e.mounted)if(Object(m.a)(Object(l.l)("project_quality_gate.successfully_updated")),n){var t=a.find(function(t){return t.id===n});t&&(e.setState({gate:t}),e.props.onComponentChange({qualityGate:t}))}else e.setState({gate:void 0})})},e}return y(e,t),e.prototype.componentDidMount=function(){this.mounted=!0,this.checkPermissions()?this.fetchQualityGates():Object(g.a)()},e.prototype.componentWillUnmount=function(){this.mounted=!1},e.prototype.checkPermissions=function(){var t=this.props.component.configuration;return!!(t&&t.showQualityGates)},e.prototype.fetchQualityGates=function(){var t=this,e=this.props.component;this.setState({loading:!0}),Promise.all([Object(f.i)({organization:e.organization}),Object(f.k)({organization:e.organization,project:e.key})]).then(function(e){var n=e[0].qualitygates,a=e[1];t.mounted&&t.setState({allGates:n,gate:a,loading:!1})},function(){t.mounted&&t.setState({loading:!1})})},e.prototype.render=function(){if(!this.checkPermissions())return null;var t=this.state,e=t.allGates,n=t.gate,o=t.loading;return a.createElement("div",{className:"page page-limited",id:"project-quality-gate"},a.createElement(h.a,{suggestions:"project_quality_gate"}),a.createElement(r.a,{title:Object(l.l)("project_quality_gate.page")}),a.createElement(c,null),o?a.createElement("i",{className:"spinner"}):e&&a.createElement(d,{allGates:e,gate:n,onChange:this.handleChangeGate}))},e}(a.PureComponent);e.default=v},695:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var a=n(662),o=n(653);function r(t){Object(a.default)().dispatch(o.b(t))}},805:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var a=n(662),o=n(693),r=n(768);function i(){var t=Object(a.default)(),e=Object(o.a)(),n=window.location.pathname+window.location.search+window.location.hash;t.dispatch(Object(r.c)()),e.replace({pathname:"/sessions/new",query:{return_to:n}})}}}]);
//# sourceMappingURL=344.1553004420962.chunk.js.map